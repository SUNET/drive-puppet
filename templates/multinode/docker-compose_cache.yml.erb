version: '3.2'

services:

    redis-server:
      image: redis:alpine
      dns:
        - 89.46.20.75
        - 89.46.21.29
        - 89.32.32.32
      volumes:
        - <%= @redis_conf_dir %>:/data
      command: redis-server /data/redis.conf --loglevel verbose
      restart: always
      networks:
<%- if @environment == 'test' -%>
        - proxysql_proxysql
<%- else %>
        - mariadb-<%= @customer %>_<%= @customer %>
<% end -%>

networks:
  mariadb-<%= @customer %>_<%= @customer %>:
    external: true
<%- if @environment == 'test' -%>
  proxysql_proxysql:
    external: true
<%- else %>
  mariadb-<%= @customer %>_<%= @customer %>:
    external: true
<% end -%>

